<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Streaming Test</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background: black;
      color: lime;
      font-size: 1.2rem;
      white-space: pre-wrap;
    }
    #output::after {
      content: "â–‹"; /* blinking cursor */
      animation: blink 1s infinite;
    }
    @keyframes blink {
      50% { opacity: 0; }
    }
  </style>
</head>
<body>
  <div id="output"></div>

  <script>
    const output = document.getElementById("output");

    // Change this URL if your function path is different
    const url = "/stream?prompt=hello";

    const evtSource = new EventSource(url);

    evtSource.addEventListener("message", (event) => {
      try {
        const data = JSON.parse(event.data);

        // Look for streaming chunks
        if (data.delta) {
          output.textContent += data.delta;
        }

        if (data.error) {
          output.textContent += "\n[Error] " + data.error;
        }

      } catch (e) {
        console.error("Parse error", e, event.data);
      }
    });

    evtSource.addEventListener("error", (err) => {
      console.error("EventSource failed:", err);
    });
  </script>
</body>
</html>
